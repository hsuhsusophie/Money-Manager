import{d as P,r as k,c as f,w as $,a as A,b as C,e,t as b,u as T,o as p,_ as x,F as R,f as F,n as L,g as O,h as G,i as Q,j as W,v as X,k as N}from"./index-CdS_1LYa.js";const y={TRANSACTIONS:"ledger_transactions",CATEGORIES:"ledger_categories",SELECTED_DATE:"ledger_selected_date",CURRENT_AMOUNT:"ledger_current_amount",SELECTED_CATEGORY:"ledger_selected_category",NOTE:"ledger_note"},S=(d,t)=>{try{const n=localStorage.getItem(d);return n?JSON.parse(n):t}catch(n){return console.error(`Error loading ${d} from localStorage:`,n),t}},D=(d,t)=>{try{localStorage.setItem(d,JSON.stringify(t))}catch(n){console.error(`Error saving ${d} to localStorage:`,n)}},w=P("ledger",()=>{const d=k(S(y.TRANSACTIONS,[])),t=k(S(y.SELECTED_DATE,new Date().toISOString().split("T")[0])),n=k(S(y.CURRENT_AMOUNT,"0")),i=k(S(y.SELECTED_CATEGORY,"")),g=k(S(y.NOTE,"")),u=k(S(y.CATEGORIES,[{id:"income",name:"收入",icon:"💰",color:"#51cf66"},{id:"food",name:"食",icon:"🍽️",color:"#ff6b6b"},{id:"drink",name:"飲料",icon:"🥤",color:"#4ecdc4"},{id:"transport",name:"交通",icon:"🚗",color:"#45b7d1"},{id:"shopping",name:"購物",icon:"🛍️",color:"#96ceb4"},{id:"entertainment",name:"娛樂",icon:"🎮",color:"#feca57"},{id:"health",name:"醫療",icon:"💊",color:"#ff9ff3"},{id:"education",name:"教育",icon:"📚",color:"#54a0ff"}])),l=k(!1),a=k(null),c=f(()=>d.value.filter(o=>o.type==="expense").reduce((o,v)=>o+v.amount,0)),s=f(()=>d.value.filter(o=>o.type==="income").reduce((o,v)=>o+v.amount,0)),r=f(()=>s.value-c.value),_=f(()=>d.value.filter(o=>o.date===t.value)),m=f(()=>{const o={};return _.value.forEach(v=>{v.type==="expense"&&(o[v.category]=(o[v.category]||0)+v.amount)}),o}),I=o=>{const v={...o,id:Date.now().toString()};d.value.push(v),n.value="0",i.value="",g.value=""},M=o=>{const v=d.value.findIndex(E=>E.id===o);v>-1&&d.value.splice(v,1)},U=o=>{t.value=o},V=o=>{n.value=o},Y=o=>{i.value=o},B=o=>{g.value=o},K=()=>{n.value="0",i.value="",g.value=""},z=o=>{const v={...o,id:Date.now().toString()};u.value.push(v)},H=(o,v)=>{const E=u.value.findIndex(h=>h.id===o);E>-1&&(u.value[E]={...u.value[E],...v})},J=o=>{if(d.value.some(h=>h.category===o))throw new Error("無法刪除已使用的分類");const E=u.value.findIndex(h=>h.id===o);E>-1&&u.value.splice(E,1)},j=o=>{l.value=o,o||(a.value=null)},q=o=>{a.value=o};return $(d,o=>{D(y.TRANSACTIONS,o)},{deep:!0}),$(t,o=>{D(y.SELECTED_DATE,o)}),$(n,o=>{D(y.CURRENT_AMOUNT,o)}),$(i,o=>{D(y.SELECTED_CATEGORY,o)}),$(g,o=>{D(y.NOTE,o)}),$(u,o=>{D(y.CATEGORIES,o)},{deep:!0}),{transactions:d,selectedDate:t,currentAmount:n,selectedCategory:i,note:g,categories:u,isEditingCategories:l,editingCategory:a,totalExpense:c,totalIncome:s,balance:r,transactionsByDate:_,categoryTotals:m,addTransaction:I,deleteTransaction:M,setSelectedDate:U,setCurrentAmount:V,setSelectedCategory:Y,setNote:B,clearForm:K,addCategory:z,updateCategory:H,deleteCategory:J,setEditingCategories:j,setEditingCategory:q}}),Z={class:"date-selector"},ee={class:"date-header"},te={class:"date-text"},oe={class:"date-summary"},ne={class:"summary-item"},se={class:"summary-value expense"},ae={class:"summary-item"},re={class:"summary-value income"},ie=A({__name:"DateSelector",setup(d){const t=w(),n=f(()=>{const l=new Date(t.selectedDate);return{year:l.getFullYear(),month:l.getMonth()+1,day:l.getDate(),weekday:["日","一","二","三","四","五","六"][l.getDay()]}}),i=f(()=>{const{year:l,month:a,day:c,weekday:s}=n.value;return`${l}年${a}月${c}日 星期${s}`}),g=l=>{const a=new Date(t.selectedDate);l==="prev"?a.setDate(a.getDate()-1):a.setDate(a.getDate()+1),t.setSelectedDate(a.toISOString().split("T")[0])},u=()=>{const l=new Date().toISOString().split("T")[0];t.setSelectedDate(l)};return(l,a)=>(p(),C("div",Z,[e("div",ee,[e("button",{class:"date-btn",onClick:a[0]||(a[0]=c=>g("prev"))},"‹"),e("div",{class:"date-display",onClick:u},[e("div",te,b(i.value),1),a[2]||(a[2]=e("div",{class:"date-hint"},"點擊回到今天",-1))]),e("button",{class:"date-btn",onClick:a[1]||(a[1]=c=>g("next"))},"›")]),e("div",oe,[e("div",ne,[a[3]||(a[3]=e("span",{class:"summary-label"},"支出",-1)),e("span",se,"$"+b(T(t).totalExpense.toFixed(0)),1)]),e("div",ae,[a[4]||(a[4]=e("span",{class:"summary-label"},"收入",-1)),e("span",re,"$"+b(T(t).totalIncome.toFixed(0)),1)])])]))}}),le=x(ie,[["__scopeId","data-v-408548b1"]]),ce={class:"category-list"},de={class:"categories-grid"},ue=["onClick"],ve={class:"category-info"},ge={class:"category-name"},me={class:"category-amount"},ye={key:0,class:"category-check"},Ce=["onClick"],pe=A({__name:"CategoryList",setup(d){const t=w(),n=f({get:()=>t.selectedCategory,set:a=>t.setSelectedCategory(a)}),i=f(()=>t.categoryTotals),g=a=>{n.value===a?n.value="":n.value=a},u=a=>{t.setEditingCategory(a),t.setEditingCategories(!0)},l=()=>{t.setEditingCategory(null),t.setEditingCategories(!0)};return(a,c)=>(p(),C("div",ce,[e("div",{class:"category-header"},[c[0]||(c[0]=e("h3",null,"選擇分類",-1)),e("div",{class:"header-actions"},[e("button",{class:"add-btn",onClick:l},"+ 新增")])]),e("div",de,[(p(!0),C(R,null,F(T(t).categories,s=>(p(),C("div",{key:s.id,class:L(["category-item",{active:n.value===s.id}]),onClick:r=>g(s.id)},[e("div",{class:"category-icon",style:G({backgroundColor:s.color})},b(s.icon),5),e("div",ve,[e("div",ge,b(s.name),1),e("div",me," $"+b((i.value[s.id]||0).toFixed(0)),1)]),n.value===s.id?(p(),C("div",ye," ✓ ")):O("",!0),e("button",{class:"edit-btn",onClick:Q(r=>u(s),["stop"])}," ✏️ ",8,Ce)],10,ue))),128))])]))}}),_e=x(pe,[["__scopeId","data-v-32783ef3"]]),fe={class:"numeric-keypad"},be={class:"display"},ke={class:"display-value"},Ee={key:0,class:"display-info"},$e={class:"keypad"},Te={class:"keypad-row"},Se={class:"keypad-row"},De={class:"keypad-row"},he=A({__name:"NumericKeypad",setup(d){const t=w(),n=f({get:()=>t.currentAmount,set:c=>t.setCurrentAmount(c)}),i=c=>{n.value==="0"?t.setCurrentAmount(c):t.setCurrentAmount(n.value+c)},g=()=>{n.value.indexOf(".")===-1&&t.setCurrentAmount(n.value+".")},u=()=>{t.setCurrentAmount("0")},l=()=>{n.value.length>1?t.setCurrentAmount(n.value.slice(0,-1)):t.setCurrentAmount("0")},a=()=>{if(!t.selectedCategory){alert("請先選擇分類");return}const c=parseFloat(n.value);if(c<=0){alert("請輸入有效金額");return}t.addTransaction({amount:c,category:t.selectedCategory,date:t.selectedDate,note:t.note,type:"expense"}),t.clearForm()};return(c,s)=>(p(),C("div",fe,[e("div",be,[e("div",ke,b(n.value),1),T(t).selectedCategory?(p(),C("div",Ee," 分類: "+b(T(t).categories.find(r=>r.id===T(t).selectedCategory)?.name),1)):O("",!0)]),e("div",$e,[e("div",{class:"keypad-row"},[e("button",{class:"keypad-btn function",onClick:u},"C"),e("button",{class:"keypad-btn function",onClick:l},"⌫"),e("button",{class:"keypad-btn function",onClick:g},"."),e("button",{class:"keypad-btn confirm",onClick:a},"✓")]),e("div",Te,[e("button",{class:"keypad-btn number",onClick:s[0]||(s[0]=r=>i("7"))},"7"),e("button",{class:"keypad-btn number",onClick:s[1]||(s[1]=r=>i("8"))},"8"),e("button",{class:"keypad-btn number",onClick:s[2]||(s[2]=r=>i("9"))},"9"),e("button",{class:"keypad-btn number",onClick:s[3]||(s[3]=r=>i("0"))},"0")]),e("div",Se,[e("button",{class:"keypad-btn number",onClick:s[4]||(s[4]=r=>i("4"))},"4"),e("button",{class:"keypad-btn number",onClick:s[5]||(s[5]=r=>i("5"))},"5"),e("button",{class:"keypad-btn number",onClick:s[6]||(s[6]=r=>i("6"))},"6"),e("button",{class:"keypad-btn number",onClick:s[7]||(s[7]=r=>i("1"))},"1")]),e("div",De,[e("button",{class:"keypad-btn number",onClick:s[8]||(s[8]=r=>i("2"))},"2"),e("button",{class:"keypad-btn number",onClick:s[9]||(s[9]=r=>i("3"))},"3"),e("button",{class:"keypad-btn number",onClick:s[10]||(s[10]=r=>i("0"))},"0"),e("button",{class:"keypad-btn function",onClick:l},"⌫")])])]))}}),Ae=x(he,[["__scopeId","data-v-441471aa"]]),xe={key:0,class:"category-editor"},Ne={class:"editor-header"},Oe={class:"editor-form"},we={class:"form-group"},Ie={class:"form-group"},Re={class:"icon-grid"},Fe=["onClick"],Le={class:"form-group"},Ge={class:"color-grid"},Me=["onClick"],Ue={class:"editor-actions"},Ve=A({__name:"CategoryEditor",setup(d){const t=w(),n=k({name:"",icon:"📝",color:"#5f27cd"}),i=["🍽️","🥤","🚗","🛍️","🎮","💊","📚","📝","🏠","🎬","🍕","☕","🚌","🛒","🎵","💉","✏️","📱","💻","🎨"],g=["#ff6b6b","#4ecdc4","#45b7d1","#96ceb4","#feca57","#ff9ff3","#54a0ff","#5f27cd","#ff9f43","#00d2d3"],u=f(()=>t.editingCategory!==null),l=()=>{t.editingCategory?n.value={...t.editingCategory}:n.value={name:"",icon:"📝",color:"#5f27cd"}},a=()=>{if(!n.value.name.trim()){alert("請輸入分類名稱");return}try{u.value&&t.editingCategory?t.updateCategory(t.editingCategory.id,{name:n.value.name,icon:n.value.icon,color:n.value.color}):t.addCategory({name:n.value.name,icon:n.value.icon,color:n.value.color}),t.setEditingCategories(!1),t.setEditingCategory(null)}catch(r){alert(r instanceof Error?r.message:"操作失敗")}},c=()=>{t.setEditingCategories(!1),t.setEditingCategory(null)},s=()=>{if(t.editingCategory&&confirm("確定要刪除此分類嗎？"))try{t.deleteCategory(t.editingCategory.id),t.setEditingCategories(!1),t.setEditingCategory(null)}catch(r){alert(r instanceof Error?r.message:"刪除失敗")}};return $(()=>t.isEditingCategories,r=>{r&&l()}),(r,_)=>T(t).isEditingCategories?(p(),C("div",xe,[e("div",Ne,[e("h3",null,b(u.value?"編輯分類":"新增分類"),1),e("button",{class:"close-btn",onClick:c},"×")]),e("div",Oe,[e("div",we,[_[1]||(_[1]=e("label",null,"分類名稱",-1)),W(e("input",{"onUpdate:modelValue":_[0]||(_[0]=m=>n.value.name=m),type:"text",placeholder:"輸入分類名稱",class:"form-input"},null,512),[[X,n.value.name]])]),e("div",Ie,[_[2]||(_[2]=e("label",null,"選擇圖標",-1)),e("div",Re,[(p(),C(R,null,F(i,m=>e("button",{key:m,class:L(["icon-btn",{active:n.value.icon===m}]),onClick:I=>n.value.icon=m},b(m),11,Fe)),64))])]),e("div",Le,[_[3]||(_[3]=e("label",null,"選擇顏色",-1)),e("div",Ge,[(p(),C(R,null,F(g,m=>e("button",{key:m,class:L(["color-btn",{active:n.value.color===m}]),style:G({backgroundColor:m}),onClick:I=>n.value.color=m},null,14,Me)),64))])]),e("div",Ue,[e("button",{class:"btn btn-secondary",onClick:c},"取消"),u.value?(p(),C("button",{key:0,class:"btn btn-danger",onClick:s}," 刪除 ")):O("",!0),e("button",{class:"btn btn-primary",onClick:a},b(u.value?"更新":"新增"),1)])])])):O("",!0)}}),Ye=x(Ve,[["__scopeId","data-v-29d01374"]]),Be={class:"home-page"},Ke=A({__name:"HomeView",setup(d){return(t,n)=>(p(),C("div",Be,[N(le),N(_e),N(Ae),N(Ye)]))}}),He=x(Ke,[["__scopeId","data-v-ef4c1f19"]]);export{He as default};
